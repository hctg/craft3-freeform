!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=167)}({167:function(e,t,a){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"undefined"===r(Craft.Freeform)&&(Craft.Freeform={}),Craft.Freeform.SubmissionsTableView=Craft.TableElementIndexView.extend({startDate:null,endDate:null,startDatepicker:null,endDatepicker:null,$chartExplorer:null,$totalValue:null,$chartContainer:null,$spinner:null,$error:null,$chart:null,$startDate:null,$endDate:null,afterInit:function(){this.$explorerContainer=$('<div class="chart-explorer-container"></div>').prependTo(this.$container),this.createChartExplorer(),this.base()},getStorage:function(e){return Craft.Freeform.SubmissionsTableView.getStorage(this.elementIndex._namespace,e)},setStorage:function(e,t){Craft.Freeform.SubmissionsTableView.setStorage(this.elementIndex._namespace,e,t)},createChartExplorer:function(){var e=$('<div class="chart-explorer"></div>').appendTo(this.$explorerContainer),t=$('<div class="chart-header"></div>').appendTo(e),a=$('<div class="date-range" />').appendTo(t),r=$('<div class="datewrapper"></div>').appendTo(a),n=$('<div class="datewrapper"></div>').appendTo(a),i=$('<div class="total"></div>').appendTo(t),s=$('<div class="total-value-wrapper"></div>').appendTo(i),o=$('<span class="total-value">&nbsp;</span>').appendTo(s);this.$chartExplorer=e,this.$totalValue=o,this.$chartContainer=$('<div class="chart-container"></div>').appendTo(e),this.$spinner=$('<div class="spinner hidden" />').prependTo(t),this.$error=$('<div class="error"></div>').appendTo(this.$chartContainer),this.$chart=$('<div class="chart"></div>').appendTo(this.$chartContainer),this.$startDate=$('<input type="text" class="text" size="20" autocomplete="off" />').appendTo(r),this.$endDate=$('<input type="text" class="text" size="20" autocomplete="off" />').appendTo(n),this.$startDate.datepicker($.extend({onSelect:$.proxy(this,"handleStartDateChange")},Craft.datepickerOptions)),this.$endDate.datepicker($.extend({onSelect:$.proxy(this,"handleEndDateChange")},Craft.datepickerOptions)),this.startDatepicker=this.$startDate.data("datepicker"),this.endDatepicker=this.$endDate.data("datepicker"),this.addListener(this.$startDate,"keyup","handleStartDateChange"),this.addListener(this.$endDate,"keyup","handleEndDateChange");var l=this.getStorage("startTime")||(new Date).getTime()-2592e6,d=this.getStorage("endTime")||(new Date).getTime();this.setStartDate(new Date(l)),this.setEndDate(new Date(d)),this.loadReport()},handleStartDateChange:function(){this.setStartDate(Craft.Freeform.SubmissionsTableView.getDateFromDatepickerInstance(this.startDatepicker))&&this.loadReport()},handleEndDateChange:function(){this.setEndDate(Craft.Freeform.SubmissionsTableView.getDateFromDatepickerInstance(this.endDatepicker))&&this.loadReport()},setStartDate:function(e){return(!this.startDate||e.getTime()!=this.startDate.getTime())&&(this.startDate=e,this.setStorage("startTime",this.startDate.getTime()),this.$startDate.val(Craft.formatDate(this.startDate)),this.endDate&&this.startDate.getTime()>this.endDate.getTime()&&this.setEndDate(new Date(this.startDate.getTime())),!0)},setEndDate:function(e){return(!this.endDate||e.getTime()!=this.endDate.getTime())&&(this.endDate=e,this.setStorage("endTime",this.endDate.getTime()),this.$endDate.val(Craft.formatDate(this.endDate)),this.startDate&&this.endDate.getTime()<this.startDate.getTime()&&this.setStartDate(new Date(this.endDate.getTime())),!0)},loadReport:function(){var e=this.settings.params;e.startDate=Craft.Freeform.SubmissionsTableView.getDateValue(this.startDate),e.endDate=Craft.Freeform.SubmissionsTableView.getDateValue(this.endDate),e.isSpam=!1,this.$spinner.removeClass("hidden"),this.$error.addClass("hidden"),this.$chart.removeClass("error"),Craft.postActionRequest("freeform/api/get-submission-data",e,$.proxy((function(e,t){if(this.$spinner.addClass("hidden"),"success"==t&&void 0===e.error){this.chart||(this.chart=new Craft.charts.Area(this.$chart));var a=new Craft.charts.DataTable(e.dataTable),r={localeDefinition:e.localeDefinition,orientation:e.orientation,formats:e.formats,dataScale:e.scale};this.chart.draw(a,r),this.$totalValue.html(e.totalHtml)}else{var n=Craft.t("An unknown error occurred.");void 0!==e&&e&&void 0!==e.error&&(n=e.error),this.$error.html(n),this.$error.removeClass("hidden"),this.$chart.addClass("error")}}),this))}},{storage:{},getStorage:function(e,t){return Craft.Freeform.SubmissionsTableView.storage[e]&&Craft.Freeform.SubmissionsTableView.storage[e][t]?Craft.Freeform.SubmissionsTableView.storage[e][t]:null},setStorage:function(e,t,a){"undefined"==r(Craft.Freeform.SubmissionsTableView.storage[e])&&(Craft.Freeform.SubmissionsTableView.storage[e]={}),Craft.Freeform.SubmissionsTableView.storage[e][t]=a},getDateFromDatepickerInstance:function(e){return new Date(e.currentYear,e.currentMonth,e.currentDay)},getDateValue:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}})}});